name: Plural up
description: TODO

vars:
  # Core variables
  branch: ''
  directory: ''
  email: ''
  gitRepo: ''
  privateKeyPath: ''
  username: ''
  token: ''
  pluralHome: ''
  gitRepoPrivateKey: ''
  project: ''
  provider: ''
  region: ''

  # GCP variables
  gcpEmail: ''
  gcpSAKeyFile: ''
  gcpOrgID: ''
  gcpBillingID: ''

testcases:
  - name: Setup Git
    steps:
      - type: git-setup
        branch: {{ .branch }}
        directory: {{ .directory }}
        email: {{ .email }}
        gitRepo: {{ .gitRepo }}
        privateKeyPath: {{ .privateKeyPath }}
        username: {{ .username }}

  - name: Setup workspace file
    steps:
      - type: workspace-setup
        name: {{ .username }}
        directory: {{ .directory }}
        provider: {{ .provider }}
        region: {{ .region }}
        email: {{ .email }}
        project: {{ .project }}

  - name: Setup context file
    steps:
      - type: context-setup
        directory: {{ .directory }}
        gitRepo: {{ .gitRepo }}
        gitRepoPrivateKey: {{ .gitRepoPrivateKey }}

  - name: Plural login
    steps:
      - type: plural-login
        email: {{ .email }}
        name: {{ .username }}
        pluralHome: {{ .pluralHome }}
        token: {{ .token }}

#  - name: Google Cloud Setup
#    steps:
#      - type: gcloud-setup
#        email: {{ .gcpEmail }}
#        saKeyFile: {{ .gcpSAKeyFile }}
#        orgID: {{ .gcpOrgID }}
#        billingID: {{ .gcpBillingID }}
#        project: {{ .project }}

  - name: Plural up
    steps:
      - script: |
          cd {{ .directory }} ;\
          plural up

#  - name: Google Cloud Teardown
#    steps:
#      - type: gcloud-teardown
#        email: {{ .gcpEmail }}
#        saKeyFile: {{ .gcpSAKeyFile }}
#        project: {{ .project }}
